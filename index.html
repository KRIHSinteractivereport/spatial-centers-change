<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="utf-8" />
    <title>국토공간거점지도 변화 보기</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <!-- ============================
         외부 라이브러리 (CDN 방식 로드)
         - Leaflet (지도)
         - PapaParse (CSV 파싱)
         - Google Fonts (폰트 & 아이콘)
       ============================ -->
    <!-- Leaflet CSS -->
    <link
      rel="stylesheet"
      href="https://unpkg.com/leaflet@1.3.1/dist/leaflet.css"
    />
    <!-- Leaflet JS -->
    <script src="https://unpkg.com/leaflet@1.3.1/dist/leaflet.js"></script>
    <!-- Leaflet Side-by-Side 플러그인 (로컬 파일) -->
    <script src="leaflet-side-by-side.js"></script>
    <!-- PapaParse: CSV 파싱 라이브러리 -->
    <script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>
    <!-- Google Fonts: Noto Sans KR 폰트 및 Material Icons -->
    <link
      href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;700&display=swap"
      rel="stylesheet"
    />
    <link
      href="https://fonts.googleapis.com/icon?family=Material+Icons"
      rel="stylesheet"
    />

    <!-- ============================
         내부 스타일 정리
       ============================ -->
    <style>
        /* 기본 body 설정 */
        body {
            margin: 0;
            padding: 0 40px;
            font-family: 'Noto Sans KR', sans-serif;
            background: white;
            color: #333;
            text-align: center;
        }

        /* 지도 컨테이너 */
        #map {
            width: 80%;
            height: 800px;
            margin: 10px auto 5px auto;
            border: 1px solid #ccc;
            position: relative;
        }

        /* 깜빡임 효과용 glow 클래스 */
        .glow-effect {
            filter: drop-shadow(0 0 1px #ffffcc);
        }

        /* 범례 바 (중심지 유형 색상 + 불투명도 슬라이더) */
        .legend-bar {
            display: flex;
            justify-content: center;
            align-items: center;
            flex-wrap: wrap;
            gap: 20px;
            margin: 40px auto 5px auto;
            padding: 10px 20px;
            width: 78%;
            background: rgba(255, 255, 255, 0.8);
            border-radius: 8px;
            box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);
        }

        /* 범례 아이템 (색상 박스 + 라벨) */
        .legend-items {
            display: flex;
            gap: 12px;
            align-items: center;
        }
        .legend-items div {
            display: flex;
            align-items: center;
            gap: 6px;
            font-size: 16px;
        }
        .legend-items span {
            width: 18px;
            height: 18px;
            display: inline-block;
            border-radius: 4px;
        }

        /* 슬라이더 컨트롤 영역 */
        .opacity-control {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .opacity-control input[type="range"] {
            width: 120px;
        }

        /* 지도 위 고정 라벨 (2021 vs 2023) */
        .map-label {
            position: absolute;
            top: 20px;
            padding: 6px 12px;
            background: rgba(0, 0, 0, 0.4);
            color: white;
            font-size: 14px;
            border-radius: 4px;
            pointer-events: none;
            z-index: 1000;
        }
        .label-left { left: 20px; }
        .label-right { right: 20px; }

        /* 대상지역 선택 UI (시도/시군구 + 버튼) */
        .SelectRow {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            align-items: center;
            justify-content: center;
        }
        .SelectRow label {
            font-size: 16px;
            font-weight: 500;
        }
        .SelectRow select {
            padding: 8px 12px;
            font-size: 16px;
            border: 1px solid #ccc;
            border-radius: 8px;
            background: #ffffff;
            min-width: 180px;
            transition: border-color 0.3s;
        }
        .SelectRow select:focus {
            border-color: #4CAF50;
            outline: none;
        }
        .SelectRow button {
            display: flex;
            align-items: center;
            gap: 6px;
            padding: 10px 20px;
            font-size: 16px;
            font-weight: 600;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: background 0.3s;
        }
        /* 확인하기 버튼 */
        #searchBtn {
            background-color: #4CAF50;
            color: white;
        }
        #searchBtn:hover {
            background-color: #43A047;
        }
        /* 분석기준 버튼 */
        #analysisBtn {
            background-color: #E0E0E0;
            color: #333;
        }
        #analysisBtn:hover {
            background-color: #BDBDBD;
        }

        /* 결과 테이블 컨테이너 */
        #resultTable {
        width: 77%;
        /* ↓ 아래쪽 여백을 0으로 해서, 탭 바와 바로 붙도록 합니다. */
        margin: 20px auto 0 auto;

        background: #fff;
        padding: 20px;

        /* ↓ “위쪽만 둥글게, 아래쪽은 직선”으로 처리 */
        border-radius: 12px 12px 0 0;

        /* ↓ 전체 테두리를 주되, 아래쪽 테두리만 제거 */
        border: 1px solid #ccc;
        border-bottom: none;

        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        overflow-x: auto;
    }
        #resultTable table {
            width: 100%;
            border-collapse: collapse;
            font-size: 16px;
        }
        #resultTable th, #resultTable td {
            border: 1px solid #ddd;
            padding: 12px;
            text-align: center;
        }
        #resultTable th {
            background-color: #f5f7fa;
            font-weight: 700;
        }
        #resultTable tr:nth-child(even) {
            background-color: #f9f9f9;
        }
        #resultTable tr:hover {
            background-color: #f1f1f1;
        }

        /* Side-by-Side 슬라이더 막대 스타일 (흰색 glow) */
        .leaflet-sbs-divider {
            background-color: #FFFFFF;
            width: 8px;
            border-radius: 4px;
            cursor: ew-resize;
            box-shadow: 0 0 12px rgba(255, 255, 255, 0.8);
        }

        /* 헤더 영역 (로고 + 제목) */
        header {
            background: white;
            padding: 25px 40px;
            display: flex;
            align-items: center;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }
        header img {
            height: 80px;
            margin-right: 20px;
        }
        header h1 {
            margin: 0;
            font-size: 28px;
            font-weight: 700;
            color: #333;
        }
        header p {
            margin: 5px 0 0 0;
            font-size: 16px;
            color: #666;
        }

        /* 섹션 (들어가기에 앞서 / 중심지 설명 등) */
        .section {
            margin: 80px auto;
            max-width: 1000px;
            line-height: 2.5;
            text-align: center;
        }

        /* 구분선 스타일 */
        .divider {
            border: none;
            border-top: 1px solid #ccc;
            width: 55%;
            margin: 60px auto;
        }

        /* Side-by-Side 슬라이더 레인지 위치 조정 */
        .leaflet-sbs-range {
            position: absolute;
            top: 50%;
            left: 0;
            width: 100%;
            transform: translateY(-50%);
            pointer-events: auto;
            z-index: 999;
        }


        
        /* ───────────────────────────────────────────────────────────
        (A) 크로스탭 테이블용 기본 스타일
        ───────────────────────────────────────────────────────────── */
        .crossTab-table {
            width: 100%;
            table-layout: fixed;   /* 열 너비를 균등 분배 */
            border-collapse: collapse;
            font-size: 15px;
        }

        /* (B) 헤더 셀 전체 동일 패딩 + 중앙 정렬 */
        .crossTab-table th {
            position: relative;       /* SVG, 텍스트 절대 위치를 위해 필요 */
            padding: 20px;            /* 모든 셀(헤더/데이터)에 동일하게 지정 */
            text-align: center;
            border: 1px solid #ddd;
            background: #f5f7fa;
            /* 높이 고정하지 않음 → 내용+padding에 따라 자동 높이 */
        }

        /* (C) 인덱스 열(첫 번째 열) 배경색만 헤더와 동일, 패딩/높이는 그대로 */
        .crossTab-table td:first-child {
            background: #f5f7fa;
            font-weight: 600;
            padding: 20px;            /* 헤더와 같은 패딩 유지 */
            text-align: center;
            border: 1px solid #ddd;
        }

        /* (D) 일반 데이터 셀 전체 중앙 정렬 + 동일 패딩 */
        .crossTab-table td {
            padding: 20px;            /* 모든 셀에 동일 패딩 */
            text-align: center;       /* 숫자/텍스트 가로 중앙 정렬 */
            border: 1px solid #ddd;
            /* 높이 고정하지 않음 → 내용+padding에 따라 자동 높이 */
        }

        /* ───────────────────────────────────────────────────────────
            (E) 대각선 SVG 헤더 셀 (padding만 동일하게 주고, height 고정 X)
        ───────────────────────────────────────────────────────────── */
        .crossTab-table th.diag-header {
            /* width, height를 지정하지 않음 */
            padding: 10px;            /* 일반 헤더와 같은 패딩 */
            background: #f5f7fa;
            /* position: relative 는 부모인 .crossTab-table th에서 이미 설정됨 */
        }

        /* SVG가 셀 높이+패딩을 자동으로 채우도록 절대 위치 지정 */
        .crossTab-table th.diag-header svg {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;             /* th 높이+패딩 전체를 덮음 */
            display: block;
        }

        /* 대각선 위쪽 텍스트(2023년) */
        .crossTab-table .diag-text-top {
            position: absolute;
            top: 10px;       /* 패딩(10px)만큼 살짝 아래로 내려서, 텍스트가 잘리지 않도록 */
            right: 8px;      /* 오른쪽 여백 */
            font-size: 14px;
            color: #333;
            white-space: nowrap;
        }

        /* 대각선 아래쪽 텍스트(2021년) */
        .crossTab-table .diag-text-bottom {
            position: absolute;
            bottom: 10px;    /* 패딩(10px)만큼 위로 올려서, 텍스트가 잘리지 않도록 */
            left: 8px;       /* 왼쪽 여백 */
            font-size: 14px;
            color: #333;
            white-space: nowrap;
        }

        /* ───────────────────────────────────────────────────────────
        main table CSS
        ───────────────────────────────────────────────────────────── */

        .main-table {
            width: 100%;
            border-collapse: collapse;
            table-layout: fixed;
            font-size: 15px;
        }
        .main-table th {
            padding: 20px;
            text-align: center;
            border: 1px solid #ddd;
            background: #f5f7fa;   /* 원하는 색깔로 바꿔도 됨 */
        }
        .main-table td {
            padding: 20px;
            text-align: center;
            border: 1px solid #ddd;
        }
        .main-table tr:nth-child(even) {
            background: #f9f9f9;
        }
        .main-table tr:hover {
            background: #f1f1f1;
        }

        /* ───────────────────────────────────────────────────────────
        탭 인터페이스용 CSS (추가)
        ───────────────────────────────────────────────────────────── */
        .tabs.tabs-bottom {
            display: flex;
            justify-content: center;
            width: 77%;               /* 콘텐츠와 동일한 너비 */
            margin: 0 auto;           /* 탭 바를 가로 중앙에 배치 */
            /* ▼ 탭 바 자체에도 위쪽 경계선이 필요합니다. */
            border-top: 2px solid #ccc;
            background: transparent;  /* 투명 배경 – 콘텐츠와 맞닿도록 */
            /* (기존에 border-bottom이었으나, 콘텐츠 위에 탭이 오기 때문에 border-top으로 변경) */
        }

        .tabs-bottom .tab {
            background: #fff;
            border: 1px solid #ccc;
            /* ▼ 탭은 이제 “위쪽 경계선”이 없어야, 콘텐츠가 아래에서 바로 붙어 보입니다. */
            border-top: none;
            /* ▼ “아래쪽 경계선”만 회색으로 두어, 탭 바 바닥이 튀어나온 형태처럼 보이게 */
            border-bottom: 2px solid #ccc;
            /* ▼ 탭 모서리는 아래쪽 모서리만 둥글게, 상단은 직선 */
            border-radius: 0 0 8px 8px;
            margin-right: 5px;
            font-weight: 500;
            padding: 12px 28px;
            cursor: pointer;
            z-index: 1;
            box-sizing: border-box;
        }

        .tabs-bottom .tab:last-child {
            margin-right: 0;
        }

        .tabs-bottom .tab.active {
            /* ▼ 활성 탭은 “아래 경계”를 강조색(녹색)으로 바꿔서 눈에 띄게 함 */
            border-bottom: 2.5px solid #4CAF50;
            /* ▼ 콘텐츠와 이어붙일 때, 탭 상단경계를 흰색으로 만들어 경계가 겹치지 않도록 함 */
            border-top: 1px solid #fff;
            background: #fff;
            z-index: 2;
            /* ▼ 활성 탭을 살짝 들어올려 콘텐츠와 연결부를 자연스럽게 보이게 */
            /*    예: 콘텐츠 아래에서 탭이 살짝 올라온 것처럼 보입니다. */
            bottom: 2px;
            position: relative;
        }

        .content {
            width: 77%;
            margin: 0 auto 0px auto; /* 탭과 콘텐츠 사이에 충분한 공간 */
            background: #fff;
            border: 1px solid #ccc;
            border-radius: 12px 12px 0 0;
            /* ▼ 콘텐츠 하단 경계를 없앰(탭 바와 붙어야 하므로). */
            border: 1px solid #ccc;
            border-bottom: none;
            padding: 24px;
            box-sizing: border-box;
            display: none; /* 탭 전환 시에 .active를 붙이면 보이도록 */
        }
        .content.active {
            display: block;
        }

        @import url('https://fonts.googleapis.com/css2?family=Nanum+Pen+Script&display=swap');
        .hand-note {
        font-family: 'Nanum Pen Script', cursive, 'Noto Sans KR', sans-serif;
        font-size: 24px;
        margin: 36px auto 0 auto;
        position: relative;
        text-align: center;
        }
        /* 이 부분이 핵심! */
        .hand-note.active .blink-text {
        animation: blinkText 2s linear 1;
        }
        @keyframes blinkText {
        0%   { opacity: 1;   }
        20%  { opacity: 0.2; }
        40%  { opacity: 1;   }
        60%  { opacity: 0.2; }
        80%  { opacity: 1;   }
        100% { opacity: 1;   }
        }
        /* (1) 초기에는 아래쪽+투명 상태 */
        .appear-bottom {
            opacity: 0;
            transform: translateY(50px);
            transition: opacity 1.3s cubic-bezier(.33,.77,.36,1.01), transform 0.7s cubic-bezier(.33,.77,.36,1.01);
        }

        /* (2) show 클래스가 붙으면 점점 선명+정위치로 */
        .appear-bottom.show {
            opacity: 1;
            transform: translateY(0);
        }
    </style>
</head>

<body>
    <!-- ============================
         헤더: 로고 + 제목 + 부제목 + 해시태그
       ============================ -->
    <header>
        <img src="img/logo_krihs.png" alt="KRIHS logo" />

        <div style="text-align: left;">
            <div style="display: flex; align-items: baseline; gap: 12px;">
                <h1 style="margin: 0; font-size: 28px; font-weight: 700; color: #333;">
                    KRIHS 인터랙티브 리포트
                </h1>
                <h2 style="margin: 0; font-size: 18px; font-weight: 600; color: #4CAF50;">
                    : 국토공간거점지도 변화 보기
                </h2>
            </div>
            <p style="margin: 6px 0 0 0; font-size: 15px; color: #666;">
                본 페이지는 2021년과 2023년 국토공간거점지도의 변화 양상을
                직관적으로 비교할 수 있도록 제작되었습니다.<br />
                아래 지도에서 슬라이더를 움직이며 두 시점의 지도를 비교해보세요.
            </p>
            <div style="margin-top: 10px; font-size: 14px; color: #999;">
                # 공간구조 # 중심지 # 인터랙티브리포트
            </div>
        </div>
    </header>

    <!-- ============================
         "들어가기에 앞서" 섹션
       ============================ -->
    <div class="section">
        <h2 style="font-size: 24px; margin-bottom: 12px; color: #333;">
            들어가기에 앞서
        </h2>
        <div
          style="font-size: 16px; color: #444; line-height: 1.6; max-width: 100%; text-align: center;"
        >
            본 페이지는 KRIHS 인터랙티브 리포트 <strong>‘한눈에 보는 국토공간거점’</strong> 콘텐츠 일부를 기반으로,<br />
            <strong>중심지 변화 비교</strong>에 초점을 맞춰 구성한 확장형 페이지임을 알려드립니다.<br />
            보다 상세한 기획 의도와 분석 과정은 아래 페이지와 리포트에서 확인하실 수 있습니다.
        </div>

        <!-- 아이콘 그룹: 보고서 다운로드 + 인터랙티브 페이지 링크 -->
        <div style="margin-top: 24px; display: flex; justify-content: center; gap: 28px;">
            <!-- 보고서 다운로드 -->
            <a
              href="report\국토연구원_2024 국토모니터링 활용가이드_배포용 최종.pdf"
              target="_blank"
              title="보고서 다운로드"
              style="color: #4CAF50; text-decoration: none;"
            >
                <div style="display: flex; flex-direction: column; align-items: center; gap: 6px;">
                    <span class="material-icons" style="font-size: 32px;">description</span>
                    <span style="font-size: 13px; color: #333;">보고서 다운로드</span>
                </div>
            </a>

            <!-- 원본 인터랙티브 리포트 링크 -->
            <a
              href="https://interactive.krihs.re.kr/interactive/"
              target="_blank"
              title="원본 인터랙티브 페이지"
              style="color: #43A047; text-decoration: none;"
            >
                <div style="display: flex; flex-direction: column; align-items: center; gap: 6px;">
                    <span class="material-icons" style="font-size: 32px;">travel_explore</span>
                    <span style="font-size: 13px; color: #333;">인터랙티브 리포트</span>
                </div>
            </a>
        </div>
    </div>

    <hr class="divider" />

    <!-- ============================
         '국토공간거점지도란?' 설명 영역
       ============================ -->
    <h2 style="font-size: 24px; margin-bottom: 25px; color: #4CAF50;">
        국토공간거점지도란?
    </h2>
    <p style="font-size: 16px; color: #555;">
        '국토공간거점지도'는 <strong>중심지 유형 분석</strong>을 통해 국토의 공간구조를 바라본 결과로,<br />
        국토성장의 핵심 거점인 중심지는 우리 국토의 공간구조를 이해하고 계획하는 데 중요한 기준이 됩니다.<br /><br />
        전국 중심지의 위치와 특성을 마이크로 단위 공간에서 정밀하게 파악하여 공간구조의 특징과 변화를 포착한다면<br />
        중심지 유형 분석을 통한 국토공간구조의 체계적 관리를 지원할 수 있을 것입니다.<br /><br />
        이에 본 리포트에서는 전국의 1km 격자를 분석 단위로, 2021년과 2023년 두 시점을 대상으로 하는<br />
        <strong>중심지 유형 분석</strong>을 진행하고 국토공간거점지도 상에 나타내었습니다.
    </p>

    <hr class="divider" />

    <!-- ============================
         '중심지 유형 분류' 애니메이션 블록
       ============================ -->
    <h2 style="font-size: 24px; margin-top: 30px; color: #4CAF50;">
        중심지 유형 분류
    </h2>
    <p style="font-size: 16px; color: #555;">
        국토공간거점지도에서 중심지 유형은 <strong>중심지Ⅰ, 중심지Ⅱ, 중심지Ⅲ-1, 중심지Ⅲ-2</strong>으로 구분됩니다.
    </p>

    <!-- 아이콘 + 텍스트 애니메이션 그리드 -->
    <style>
        .center-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 40px;
            margin: 60px auto;
            max-width: 1000px;
            padding: 0 20px;
        }
        .center-item {
            border-top: 1.3px solid #eeeeeec7;
            border-bottom: 1.3px solid #eeeeeee7;
            padding: 28px 0;
            text-align: center;
            transition: all 0.6s ease;
            opacity: 0;
            transform: translateY(40px);
        }
        .center-item.show {
            opacity: 1;
            transform: translateY(0);
        }
        .center-icon {
            font-size: 48px;
            margin-bottom: 16px;
            filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.2));
        }
        .center-title {
            font-weight: 600;
            font-size: 17px;
            margin-bottom: 4px;
        }
        .center-sub {
            font-size: 14px;
            color: #888;
            margin-bottom: 10px;
        }
        .center-desc {
            font-size: 15px;
            color: #555;
            line-height: 1.5;
        }
    </style>

    <div class="center-grid">
        <div class="center-item" style="transition-delay: 0.1s;">
            <span class="material-icons center-icon" style="color: #FF6B6B;">location_city</span>
            <div class="center-title">중심지 Ⅰ</div>
            <div class="center-sub">거점, 도심</div>
            <div class="center-desc">거주·근무인구 밀도 높고<br />통근 중심성 강함</div>
        </div>
        <div class="center-item" style="transition-delay: 0.3s;">
            <span class="material-icons center-icon" style="color: #FF85C1;">apartment</span>
            <div class="center-title">중심지 Ⅱ</div>
            <div class="center-sub">준거점, 부심</div>
            <div class="center-desc">중밀의 인구 구조 및<br />통근 중심성</div>
        </div>
        <div class="center-item" style="transition-delay: 0.5s;">
            <span class="material-icons center-icon" style="color: #4DDBC3;">engineering</span>
            <div class="center-title">중심지 Ⅲ-1</div>
            <div class="center-sub">일자리거점</div>
            <div class="center-desc">근무인구 중심의<br />고용 집적지</div>
        </div>
        <div class="center-item" style="transition-delay: 0.7s;">
            <span class="material-icons center-icon" style="color: #5C9EFF;">local_hospital</span>
            <div class="center-title">중심지 Ⅲ-2</div>
            <div class="center-sub">기초생활거점</div>
            <div class="center-desc">공공서비스 접근성 높고<br />거주인구 규모 큼</div>
        </div>
    </div>

    <!-- IntersectionObserver를 이용하여 스크롤 시 애니메이션 트리거 -->
    <script>
        const observer = new IntersectionObserver(
            (entries) => {
                entries.forEach((entry) => {
                    if (entry.isIntersecting) {
                        entry.target.classList.add('show');
                    } else {
                        entry.target.classList.remove('show');
                    }
                });
            },
            { threshold: 0.1 }
        );
        document.querySelectorAll('.center-item').forEach((el) => observer.observe(el));
    </script>

    <p style="font-size: 16px; color: #555;">
        아래 토글을 눌러 세부적인 중심지 유형별 기준과 핵심 지표의 데이터 출처를 확인해보세요.
    </p>

    <!-- ============================
         세부 기준 및 데이터 출처 보기 토글
       ============================ -->
    <div
      id="customToggle"
      style="display: flex; align-items: center; gap: 8px; cursor: pointer; font-size: 16px; color: #555; margin: 30px auto; user-select: none; width: fit-content;"
    >
        <span id="toggleIcon">▶</span>
        <span>세부 기준 및 데이터 출처 보기</span>
    </div>

    <!-- 숨겨진 토글 콘텐츠 (표) -->
    <div
      id="toggleContent"
      style="
        display: none;
        margin: 30px auto;
        padding: 30px 40px;
        background: #ffffff;
        border-radius: 12px;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
        max-width: 1000px;
        text-align: left;
      "
    >
        <!-- 중심지 유형별 기준 표 -->
        <h3 style="font-size: 20px; margin-top: 30px; color: #333; text-align: left;">
            중심지 유형별 기준
        </h3>
        <div style="margin-top: 20px; overflow-x: auto;">
            <table
              style="width: 100%; min-width: 700px; border-collapse: collapse; font-size: 14px; text-align: center;"
            >
                <thead>
                    <tr style="background-color: #f5f7fa;">
                        <th style="border: 1px solid #ddd; padding: 12px;">중심지 유형</th>
                        <th style="border: 1px solid #ddd; padding: 12px;">거주인구 밀도 (명/㎢)</th>
                        <th style="border: 1px solid #ddd; padding: 12px;">근무인구 밀도 (명/㎢)</th>
                        <th style="border: 1px solid #ddd; padding: 12px;">유입 중심성 지수</th>
                        <th style="border: 1px solid #ddd; padding: 12px;">유출 중심성 지수</th>
                        <th style="border: 1px solid #ddd; padding: 12px;">공공서비스 접근성 (반경 km)</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td style="border: 1px solid #ddd; padding: 12px;">중심지 I</td>
                        <td style="border: 1px solid #ddd; padding: 12px;">≥ 1,500</td>
                        <td style="border: 1px solid #ddd; padding: 12px;">≥ 900</td>
                        <td style="border: 1px solid #ddd; padding: 12px;">≥ 0.035</td>
                        <td style="border: 1px solid #ddd; padding: 12px;">≥ 0.03</td>
                        <td style="border: 1px solid #ddd; padding: 12px;">-</td>
                    </tr>
                    <tr>
                        <td style="border: 1px solid #ddd; padding: 12px;">중심지 II</td>
                        <td style="border: 1px solid #ddd; padding: 12px;">≥ 300</td>
                        <td style="border: 1px solid #ddd; padding: 12px;">≥ 150</td>
                        <td style="border: 1px solid #ddd; padding: 12px;">≥ 0.035</td>
                        <td style="border: 1px solid #ddd; padding: 12px;">≥ 0.03</td>
                        <td style="border: 1px solid #ddd; padding: 12px;">-</td>
                    </tr>
                    <tr>
                        <td style="border: 1px solid #ddd; padding: 12px;">중심지 III-1</td>
                        <td style="border: 1px solid #ddd; padding: 12px;">-</td>
                        <td style="border: 1px solid #ddd; padding: 12px;">≥ 150</td>
                        <td style="border: 1px solid #ddd; padding: 12px;">-</td>
                        <td style="border: 1px solid #ddd; padding: 12px;">-</td>
                        <td style="border: 1px solid #ddd; padding: 12px;">-</td>
                    </tr>
                    <tr>
                        <td style="border: 1px solid #ddd; padding: 12px;">중심지 III-2</td>
                        <td style="border: 1px solid #ddd; padding: 12px;">≥ 150</td>
                        <td style="border: 1px solid #ddd; padding: 12px;">-</td>
                        <td style="border: 1px solid #ddd; padding: 12px;">-</td>
                        <td style="border: 1px solid #ddd; padding: 12px;">-</td>
                        <td style="border: 1px solid #ddd; padding: 12px;">≤ 1.5</td>
                    </tr>
                </tbody>
            </table>
        </div>
        <p style="font-size: 14px; color: #666; margin-top: 10px; text-align: left;">
            ※ 유입 중심성 ≥ 0.035, 유출 중심성 ≥ 0.03은 전국 1km 격자 기준 상위 20% 수준<br />
            ※ UN 도시구분 기준을 참고하여 인구밀도 1,500명/㎢, 300명/㎢, 150명/㎢ 기준 활용
        </p>

        <!-- 핵심 지표 데이터 출처 표 -->
        <h3 style="font-size: 20px; margin-top: 30px; color: #333; text-align: left;">
            핵심 지표 데이터 출처
        </h3>
        <div style="margin-top: 20px; overflow-x: auto;">
            <table
              style="width: 100%; min-width: 700px; border-collapse: collapse; font-size: 14px; text-align: center;"
            >
                <thead>
                    <tr style="background-color: #f5f7fa;">
                        <th style="border: 1px solid #ddd; padding: 12px;">핵심 지표</th>
                        <th style="border: 1px solid #ddd; padding: 12px;">공간 단위</th>
                        <th style="border: 1px solid #ddd; padding: 12px;">데이터셋</th>
                        <th style="border: 1px solid #ddd; padding: 12px;">기준연도</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td style="border: 1px solid #ddd; padding: 12px;">거주인구 밀도</td>
                        <td style="border: 1px solid #ddd; padding: 12px;">1km x 1km 격자</td>
                        <td style="border: 1px solid #ddd; padding: 12px;">통계청 통계지리정보서비스(SGIS) 격자단위 인구</td>
                        <td style="border: 1px solid #ddd; padding: 12px;">2022년, 2021년</td>
                    </tr>
                    <tr>
                        <td style="border: 1px solid #ddd; padding: 12px;">근무인구 밀도</td>
                        <td style="border: 1px solid #ddd; padding: 12px;">1km x 1km 격자</td>
                        <td style="border: 1px solid #ddd; padding: 12px;">KCB 직장주소지 기준 인구</td>
                        <td style="border: 1px solid #ddd; padding: 12px;">2023년, 2021년</td>
                    </tr>
                    <tr>
                        <td style="border: 1px solid #ddd; padding: 12px;">유입, 유출 중심성 지수</td>
                        <td style="border: 1px solid #ddd; padding: 12px;">1km x 1km 격자</td>
                        <td style="border: 1px solid #ddd; padding: 12px;">KCB 자택주소지-직장주소지 행렬</td>
                        <td style="border: 1px solid #ddd; padding: 12px;">2023년, 2021년</td>
                    </tr>
                    <tr>
                        <td style="border: 1px solid #ddd; padding: 12px;">공공서비스시설 접근성</td>
                        <td style="border: 1px solid #ddd; padding: 12px;">1km x 1km 격자</td>
                        <td style="border: 1px solid #ddd; padding: 12px;">관공서, 보건의료기관, 초등학교, 경찰서 POI 데이터</td>
                        <td style="border: 1px solid #ddd; padding: 12px;">2024년, 2023년, 2022년, 2021년</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>

    <!-- 토글 버튼 클릭 시 콘텐츠 열고 닫는 스크립트 -->
    <script>
        document.getElementById('customToggle').addEventListener('click', () => {
            const content = document.getElementById('toggleContent');
            const icon = document.getElementById('toggleIcon');
            const isVisible = content.style.display === 'block';
            content.style.display = isVisible ? 'none' : 'block';
            icon.textContent = isVisible ? '▶' : '▼';
        });
    </script>

    <hr class="divider" />

    <!-- ============================
         범례 바 (중심지 유형 색상 + 불투명도 슬라이더)
       ============================ -->
    <div class="legend-bar">
        <!-- 색상별 범례 -->
        <div class="legend-items">
            <div><span style="background: #b2df8a;"></span> 주변부</div>
            <div><span style="background: #e31a1c;"></span> 중심지 I</div>
            <div><span style="background: #f032ea;"></span> 중심지 II</div>
            <div><span style="background: #4acad1;"></span> 중심지 III-1</div>
            <div><span style="background: #2b25e1;"></span> 중심지 III-2</div>
        </div>
        <!-- 불투명도 조절 슬라이더 -->
        <div class="opacity-control">
            <label for="opacitySlider" style="font-size: 14px;">타일 불투명도</label>
            <input type="range" id="opacitySlider" min="0" max="1" step="0.01" value="0.6" />
            <span id="opacityValue">100%</span>
        </div>
    </div>

    <!-- ============================
         지도를 보여줄 섹션
       ============================ -->
    <section>
        <!-- 지도 컨테이너 + 고정 라벨 -->
        <div id="map">
            <div class="map-label label-left">2021년 국토공간거점지도</div>
            <div class="map-label label-right">2023년 국토공간거점지도</div>
        </div>

        <!-- 목표/설명 텍스트 -->
        <div style="text-align: center; margin-top: 40px;">
            <div
              style="font-size: 28px; font-weight: bold; color: #333; display: flex; justify-content: center; align-items: center; gap: 8px;"
            >
                <span class="material-icons" style="font-size: 32px; color: #4CAF50;">place</span>
                대상지역 설정
            </div>
            <div style="margin-top: 10px; font-size: 18px; color: #666;">
                대상지역을 설정하여 해당 위치로 줌인하고 중심지 유형이 어떻게 바뀌었는지 탐색하세요.
            </div>
        </div>

        <!-- 시도/시군구 선택 + 버튼 -->
        <div
          style="display: flex; justify-content: center; align-items: center; gap: 12px; margin-top: 30px; margin-bottom: 50px; flex-wrap: wrap;"
        >
            <label for="sidoSelect" style="font-size: 16px;">시도 선택:</label>
            <select
              id="sidoSelect"
              style="padding: 8px 12px; border: 1px solid #ccc; border-radius: 6px; font-size: 16px; min-width: 160px;"
            ></select>

            <label for="sggSelect" style="font-size: 16px;">시군구 선택:</label>
            <select
              id="sggSelect"
              style="padding: 8px 12px; border: 1px solid #ccc; border-radius: 6px; font-size: 16px; min-width: 160px;"
            ></select>

            <button
              id="searchBtn"
              style="padding: 8px 20px; background-color: #4CAF50; color: white; border: none; border-radius: 6px; font-size: 16px; font-weight: bold; cursor: pointer;"
            >
                확인하기
            </button>

            <button
              id="analysisBtn"
              style="padding: 8px 20px; background-color: #666; color: white; border: none; border-radius: 6px; font-size: 16px; font-weight: bold; cursor: pointer;"
            >
                분석기준
            </button>
        </div>


        <!-- 탭을 위로 올림 -->
 
        <div class="tab-content-wrap">
            <div id="base" class="content active">...</div>
            <div id="expanded" class="content">...</div>
            <div class="tabs tabs-bottom">
                <div class="tab active" data-target="base">기본 테이블</div>
                <div class="tab" data-target="expanded">확장 테이블</div>
            </div>
        </div>

        <!-- ───────────────────────────────────────────────────────────
            탭 전환용 JS
        ──────────────────────────────────────────────────────────── -->
        <script>
            const tabs = document.querySelectorAll('.tab');
            tabs.forEach(tab => {
                tab.addEventListener('click', () => {
                    // 1) 모든 탭에서 active 클래스 제거
                    tabs.forEach(t => t.classList.remove('active'));
                    // 2) 클릭된 탭에만 active 부여
                    tab.classList.add('active');
                    // 3) 모든 콘텐츠 영역 숨기기
                    document.querySelectorAll('.content').forEach(c => c.classList.remove('active'));
                    // 4) 클릭한 탭의 data-target 값에 해당하는 콘텐츠만 보이기
                    const targetId = tab.getAttribute('data-target');
                    document.getElementById(targetId).classList.add('active');
                });
            });
        </script>

        <!-- 안내 텍스트 -->
        <div id="handNote" class="hand-note">
            <span class="blink-text">
                어떤 중심지 유형에서 어떤 중심지 유형으로 변했는지<br>
                <span style="color: #4CAF50;">확장 테이블</span> 탭을 눌러 세부적인 변화를 확인해보세요!
            </span>
            </span>
        </div>
        </div>

    </section>

    <!-- ============================
         지도 초기화 및 레이어 추가 스크립트
       ============================ -->
    <script>
        // 1) Leaflet 지도 초기화
        var map = L.map('map', {
            zoomControl: false, // 기본 zoom control 비활성화
            maxZoom: 12
        }).setView([37.5665, 126.9780], 7);

        // 2) 우측 하단에 zoom control 추가
        L.control.zoom({ position: 'bottomright' }).addTo(map);

        // 3) OSM 기본 베이스 레이어
        var osm = L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            attribution: '&copy; OpenStreetMap contributors',
            maxZoom: 19
        }).addTo(map);

        // 4) 2021년, 2023년 타일 레이어 생성 및 지도에 추가
        var layer2021 = L.tileLayer('./map_21/Mapnik/{z}/{x}/{y}.png', {
            attribution: '국토공간거점지도 2021',
            minZoom: 7,
            maxZoom: 12
        }).addTo(map);

        var layer2023 = L.tileLayer('./map_23/Mapnik/{z}/{x}/{y}.png', {
            attribution: '국토공간거점지도 2023',
            minZoom: 7,
            maxZoom: 12
        }).addTo(map);

        // 5) Side-by-Side 컨트롤 활성화 (슬라이더 비교)
        L.control.sideBySide(layer2021, layer2023).addTo(map);

        // 6) 불투명도 조절 슬라이더 이벤트 리스너
        document.getElementById('opacitySlider').addEventListener('input', function () {
            const opacity = parseFloat(this.value);
            layer2021.setOpacity(opacity);
            layer2023.setOpacity(opacity);
            document.getElementById('opacityValue').textContent = Math.round(opacity * 100) + '%';
        });

        // 7) 초기 불투명도 값 설정 (60% 불투명도)
        layer2021.setOpacity(0.6);
        layer2023.setOpacity(0.6);
        document.getElementById('opacityValue').textContent = '60%';
    </script>

    <!-- ============================
         강조/하이라이트 로직 (GeoJSON 로드 및 함수) 
         → change_highlight.js
       ============================ -->
    <script src="change_highlight_v2.js"></script>

    <!-- ============================
         지역 선택 및 통계 테이블 생성 로직 
         → region_control.js
       ============================ -->
    <script src="region_control_v2.js"></script>

    <!-- 👇 IntersectionObserver로 handNote 등장 효과 (여기다가 넣으세요!) -->
    <script>
    // hand-note 등장/깜빡임 효과
    const handNote = document.getElementById('handNote');
    if (handNote) {
        const obs = new IntersectionObserver((entries) => {
        entries.forEach((entry) => {
            if (entry.isIntersecting) {
            handNote.classList.add('active');
            setTimeout(() => handNote.classList.remove('active'), 2200);
            }
        });
        }, { threshold: 0.3 });
        obs.observe(handNote);
    }
    </script>


    <hr class="divider" />

    <!-- 마무리 멘트 + 회귀 버튼 (상단 분위기 통일) -->
    <div id="finalCallToAction" class="appear-bottom" style="max-width: 900px; margin: 60px auto 35px auto; text-align: center;">
        <div style="font-size: 16px; color: #444; margin-bottom: 22px; line-height: 1.8;">
            더 다양한 주제와 분석이 궁금하신가요?<br>
            아래의 인터랙티브 리포트 페이지에서 탐색해보세요.
        </div>
        <a href="https://interactive.krihs.re.kr/interactive/" target="_blank"
            style="display: inline-flex; align-items: center; gap: 8px; background: #4CAF50; color: #fff;
                    font-size: 16px; font-weight: 500; padding: 13px 34px; border-radius: 8px;
                    text-decoration: none; box-shadow: 0 2px 6px rgba(76,175,80,0.08); transition: background 0.2s;">
            <span class="material-icons" style="font-size: 22px;">travel_explore</span>
            인터랙티브 리포트로 이동
        </a>
    </div>

        <!-- 3. 스크립트 (맨 아래에 두면 제일 안전) -->
    <script>
        const target = document.getElementById('finalCallToAction');

        function checkIfBottom() {
            const scrollPos = window.scrollY + window.innerHeight;
            const docHeight = document.documentElement.scrollHeight;
            if (Math.abs(scrollPos - docHeight) < 2) { // 2px 이내면 진짜 바닥
                target.classList.add('show');
            } else {
                target.classList.remove('show');
            }
        }

        window.addEventListener('scroll', checkIfBottom);
        window.addEventListener('resize', checkIfBottom);

        // 페이지 처음 로드 시에도 체크
        checkIfBottom();
    </script>

    <!-- ============================
         푸터 (기관 정보 등)
       ============================ -->
    <footer style="margin-top: 80px; padding: 40px 20px; border-top: 1px solid #ddd; font-size: 14px; color: #333;">
        <div style="max-width: 1000px; margin: auto; text-align: center;">
            <!-- 기관 정보 -->
            <p style="font-weight: 600; margin-bottom: 6px;">
                KRIHS 인터랙티브 리포트: 국토공간거점지도 변화 보기
            </p>
            <p style="color: #888; margin: 0 0 16px;">
                (30147) 세종특별자치시 국책연구원로 5 (반곡동)<br />
                Copyright© Korea Research Institute for Human Settlements. ALL RIGHTS RESERVED.
            </p>

            <!-- 작성자/문의처 -->
            <p style="margin: 0 0 2px;">
                ▪︎ 작성 및 문의: 국토연구원 국토모니터링연구센터
            </p>
            <p style="margin: 0;">▪︎ 작성연월: 2025년 6월</p>
        </div>
    </footer>
</body>
</html>
